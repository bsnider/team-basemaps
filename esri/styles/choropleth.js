// COPYRIGHT Â© 2016 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.

define(["dojo/_base/array","dojo/_base/lang","../Color","./colors"],function(e,r,l,i){function o(r,i){return e.map(r,function(e){var r=new l(e);return null!=i&&(r.a=i),r})}function a(e,r){return e.r===r.r&&e.g===r.g&&e.b===r.b}function n(r,l){var i,o=0;if(r.length===l.length)if(i=e.every(r,function(e,r){return a(e,l[r])}))o=1;else{var n=r.slice(0).reverse();i=e.every(n,function(e,r){return a(e,l[r])}),i&&(o=-1)}return o}function g(r,l){var i,o;if(o=n(l,r.colors))i=o>0?r:x.flipColors(r,!0);else{var a;e.some(r.colorsForClassBreaks,function(e){return e.numClasses===l.length&&(a=e.colors),!!a}),a&&(o=n(l,a),o&&(i=o>0?r:x.flipColors(r,!0)))}return i}function t(r,l){var i,o,a,n=r&&r.basemapGroups,g=r&&r.basemaps;if(n)for(i in n)if(g=n[i],o=e.indexOf(g,l),o>-1){a=i;break}return a=a||l,r&&a?r.schemes[a]:null}function s(e){var r,l=e.basemapGroups,i=e.basemaps,o=[];if(l)for(r in l)o=o.concat(l[r]);else i&&(o=o.concat(i));return o}function m(r,a,n,g,t){var s,m,d,h=i[r];if(h){s={id:g+"/"+t+"/"+r,theme:g},d=a.fillOpacity,null==d&&-1!==e.indexOf(c,r)&&(d=.8),s.colors=o(h.stops,d),s.colorsForClassBreaks=[];for(m in h)"stops"!==m&&(m=+m,s.colorsForClassBreaks.push({numClasses:m,colors:o(h[m],d)}));switch(s.noDataColor=new l(-1!==e.indexOf(c,r)?u:y),null!=d&&(s.noDataColor.a=d||1),n){case"point":s.outline={color:new l(a.outline.color),width:a.outline.width},s.size=a.size;break;case"polyline":s.width=a.width;break;case"polygon":s.outline={color:new l(a.outline.color),width:a.outline.width}}}return s}function d(e){return e}var h={light:{color:[128,128,128,1],width:.5},lighter:{color:[153,153,153,1],width:.5}},p={lightBasemaps:{outline:h.lighter,fillOpacity:.8,width:2,size:8},darkBasemaps:{outline:h.light,fillOpacity:.6,width:2,size:8}},y="#aaaaaa",u="#ffffff",c=["highlight-orange-gray","highlight-bluegreen-gray","highlight-purple-gray","highlight-pink-gray","highlight-blue-gray","highlight-red-gray","highlight-orange-gray-dark","highlight-blue-gray-dark","highlight-orange-gray-bright","highlight-blue-gray-bright","extremes-orange-gray","extremes-bluegreen-gray","extremes-purple-gray","extremes-pink-gray","extremes-blue-gray","extremes-red-gray","extremes-orange-gray-dark","extremes-blue-gray-dark","extremes-orange-gray-bright","extremes-blue-gray-bright"],b=["seq-single-blues","seq-single-greens","seq-single-grays","seq-single-oranges","seq-single-purples","seq-single-reds","seq-multi-bugn","seq-multi-bupu","seq-multi-gnbu","seq-multi-orrd","seq-multi-pubu","seq-multi-pubugn","seq-multi-purd","seq-multi-rdpu","seq-multi-ylgn","seq-multi-ylgnbu","seq-multi-ylorbr","seq-multi-ylorrd"],w=["div-brbg","div-piyg","div-prgn","div-puor","div-rdbu","div-rdgy","div-rdylbu","div-rdylgn","div-spectral"],v={"high-to-low":{name:"high-to-low",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:p.lightBasemaps,primary:"seq-yellow-orange-red",secondary:["seq-yellow-red-purple","seq-yellow-pink-purple","seq-yellow-purple-blue","seq-yellow-green-blue"].concat(b)},gray:{common:p.lightBasemaps,primary:"seq-yellow-orange-red",secondary:["seq-orange-red-light","seq-yellow-red-purple","seq-yellow-pink-purple","seq-yellow-purple-blue"].concat(b)},topo:{common:p.lightBasemaps,primary:"seq-yellow-pink-purple",secondary:["seq-yellow-purple-blue","seq-yellow-red-purple","seq-yellow-orange-red","seq-yellow-green-blue"].concat(b)},terrain:{common:p.lightBasemaps,primary:"seq-pink-red",secondary:["seq-yellow-pink-purple","seq-yellow-red-purple","seq-yellow-orange-red","seq-orange-red-light"].concat(b)},"national-geographic":{common:p.lightBasemaps,primary:"seq-yellow-red-purple",secondary:["seq-yellow-orange-red","seq-yellow-pink-purple","seq-yellow-purple-blue","seq-yellow-green-blue"].concat(b)},oceans:{common:p.lightBasemaps,primary:"seq-yellow-red-purple",secondary:["seq-yellow-green-blue","seq-yellow-orange-red","seq-yellow-pink-purple","seq-yellow-purple-blue"].concat(b)},osm:{common:p.lightBasemaps,primary:"seq-red-blue-green",secondary:["seq-yellow-pink-purple","seq-yellow-red-purple","seq-yellow-purple-blue"].concat(b)},satellite:{common:p.darkBasemaps,primary:"seq-orange-red-dark",secondary:["seq-yellow-green-blue","seq-red-blue-green","seq-yellow-purple-blue"].concat(b)},hybrid:{common:p.darkBasemaps,primary:"seq-orange-red-dark",secondary:["seq-yellow-green-blue","seq-red-blue-green","seq-yellow-purple-blue"].concat(b)},"dark-gray":{common:p.darkBasemaps,primary:"seq-yellow-orange-red-bright",secondary:[].concat(b)}}},"above-and-below":{name:"above-and-below",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:p.lightBasemaps,primary:"div-bluegreen-yellow-orange",secondary:["div-orange-yellow-blue-light","div-green-yellow-redpurple","div-green-yellow-orange"].concat(w)},gray:{common:p.lightBasemaps,primary:"div-orange-purple",secondary:["div-bluegreen-purple","div-bluegreen-orange","div-orange-pink"].concat(w)},topo:{common:p.lightBasemaps,primary:"div-orange-pink",secondary:["div-redpurple-blue","div-orange-blue","div-green-pink"].concat(w)},terrain:{common:p.lightBasemaps,primary:"div-bluegreen-orange",secondary:["div-bluegreen-redpurple","div-green-redpurple","div-green-orange"].concat(w)},"national-geographic":{common:p.lightBasemaps,primary:"div-orange-yellow-blue-light",secondary:["div-bluegreen-yellow-orange","div-green-yellow-redpurple"].concat(w)},oceans:{common:p.lightBasemaps,primary:"div-red-yellow-pink",secondary:["div-blue-green","div-bluegreen-yellow-redpurple","div-bluegreen-yellow-orange"].concat(w)},osm:{common:p.lightBasemaps,primary:"div-bluegreen-pink",secondary:["div-bluegreen-redpurple","div-bluegreen-orange","div-orange-pink"].concat(w)},satellite:{common:p.darkBasemaps,primary:"div-orange-yellow-blue-dark",secondary:["div-red-yellow-purple","div-orange-yellow-pink","div-orange-yellow-blue-light"].concat(w)},hybrid:{common:p.darkBasemaps,primary:"div-orange-yellow-blue-dark",secondary:["div-red-yellow-purple","div-orange-yellow-pink","div-orange-yellow-blue-light"].concat(w)},"dark-gray":{common:p.darkBasemaps,primary:"div-orange-gray-blue",secondary:["div-yellow-gray-purple","div-red-gray-blue","div-green-gray-purple"].concat(w)}}},"centered-on":{name:"centered-on",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:{outline:h.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-bluegreen","highlight-orange-gray","highlight-bluegreen-gray"]},gray:{common:{outline:h.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-purple","highlight-orange-gray","highlight-purple-gray"]},topo:{common:{outline:h.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-pink","highlight-orange-gray","highlight-pink-gray"]},terrain:{common:{outline:h.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-bluegreen","highlight-orange-gray","highlight-bluegreen-gray"]},"national-geographic":{common:{outline:h.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-blue","highlight-orange-gray","highlight-blue-gray"]},oceans:{common:{outline:h.lighter,width:2,size:8},primary:"highlight-red",secondary:["highlight-pink","highlight-red-gray","highlight-pink-gray"]},osm:{common:{outline:h.lighter,width:2,size:8},primary:"highlight-pink",secondary:["highlight-bluegreen","highlight-pink-gray","highlight-bluegreen-gray"]},satellite:{common:{outline:h.light,width:2,size:8},primary:"highlight-orange-dark",secondary:["highlight-blue-dark","highlight-orange-gray-dark","highlight-blue-gray-dark"]},hybrid:{common:{outline:h.light,width:2,size:8},primary:"highlight-orange-dark",secondary:["highlight-blue-dark","highlight-orange-gray-dark","highlight-blue-gray-dark"]},"dark-gray":{common:{outline:h.light,width:2,size:8},primary:"highlight-orange-bright",secondary:["highlight-blue-bright","highlight-orange-gray-bright","highlight-blue-gray-bright"]}}},extremes:{name:"extremes",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-bluegreen-yellow-orange",secondary:["extremesdiv-orange-yellow-blue-light","extremesdiv-green-yellow-redpurple","extremesdiv-green-yellow-orange","extremes-orange","extremes-bluegreen","extremes-orange-gray","extremes-bluegreen-gray"]},gray:{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-orange-purple",secondary:["extremesdiv-bluegreen-purple","extremesdiv-bluegreen-orange","extremesdiv-orange-pink","extremes-orange","extremes-purple","extremes-orange-gray","extremes-purple-gray"]},topo:{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-orange-pink",secondary:["extremesdiv-redpurple-blue","extremesdiv-orange-blue","extremesdiv-green-pink","extremes-orange","extremes-pink","extremes-orange-gray","extremes-pink-gray"]},terrain:{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-bluegreen-orange",secondary:["extremesdiv-bluegreen-redpurple","extremesdiv-green-redpurple","extremesdiv-green-orange","extremes-orange","extremes-bluegreen","extremes-orange-gray","extremes-bluegreen-gray"]},"national-geographic":{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-orange-yellow-blue-light",secondary:["extremesdiv-bluegreen-yellow-orange","extremesdiv-green-yellow-redpurple","extremes-orange","extremes-blue","extremes-orange-gray","extremes-blue-gray"]},oceans:{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-red-yellow-pink",secondary:["extremesdiv-blue-green","extremesdiv-bluegreen-yellow-redpurple","extremesdiv-bluegreen-yellow-orange","extremes-red","extremes-pink","extremes-red-gray","extremes-pink-gray"]},osm:{common:{outline:h.lighter,width:2,size:8},primary:"extremesdiv-bluegreen-pink",secondary:["extremesdiv-bluegreen-redpurple","extremesdiv-bluegreen-orange","extremesdiv-orange-pink","extremes-pink","extremes-bluegreen","extremes-pink-gray","extremes-bluegreen-gray"]},satellite:{common:{outline:h.light,width:2,size:8},primary:"extremesdiv-orange-yellow-blue-dark",secondary:["extremesdiv-red-yellow-purple","extremesdiv-orange-yellow-pink","extremesdiv-orange-yellow-blue-light","extremes-orange-dark","extremes-blue-dark","extremes-orange-gray-dark","extremes-blue-gray-dark"]},hybrid:{common:{outline:h.light,width:2,size:8},primary:"extremesdiv-orange-yellow-blue-dark",secondary:["extremesdiv-red-yellow-purple","extremesdiv-orange-yellow-pink","extremesdiv-orange-yellow-blue-light","extremes-orange-dark","extremes-blue-dark","extremes-orange-gray-dark","extremes-blue-gray-dark"]},"dark-gray":{common:{outline:h.light,width:2,size:8},primary:"extremesdiv-orange-gray-blue",secondary:["extremesdiv-yellow-gray-purple","extremesdiv-red-gray-blue","extremesdiv-green-gray-purple","extremes-orange-bright","extremes-blue-bright","extremes-orange-gray-bright","extremes-blue-gray-bright"]}}},"group-similar":{name:"group-similar",label:"TODO",description:"TODO",basemapGroups:{light:["streets","gray","topo","terrain","national-geographic","oceans","osm"],dark:["satellite","hybrid","dark-gray"]},schemes:{light:{common:p.lightBasemaps,primary:"spectral",secondary:["cat-dark-6","cat-light-6"]},dark:{common:p.darkBasemaps,primary:"spectral",secondary:["cat-dark-6","cat-light-6"]}}}},x={};return r.mixin(x,{getAvailableThemes:function(r){var l,i,o,a=[];for(l in v)i=v[l],o=s(i),r&&-1===e.indexOf(o,r)||a.push({name:i.name,label:i.label,description:i.description,basemaps:o});return a},getSchemes:function(r){var l,i,o=r.theme,a=r.basemap,n=d(r.geometryType),g=v[o];return l=t(g,a),l&&(i={primaryScheme:m(l.primary,l.common,n,o,a),secondarySchemes:e.map(l.secondary,function(e){return m(e,l.common,n,o,a)})}),i},getSchemeById:function(e){var r,l,i,o,a,n=e.id,g=d(e.geometryType);return n&&(n=n.split("/"),n&&(l=n[0],i=n[1],o=n[2])),a=t(v[l],i),a&&(r=m(o,a.common,g,l,i)),r},cloneScheme:function(i){var a;return i&&(a=r.mixin({},i),a.colors=o(a.colors),a.colorsForClassBreaks=e.map(a.colorsForClassBreaks,function(e){return{numClasses:e.numClasses,colors:o(e.colors)}}),a.noDataColor&&(a.noDataColor=new l(a.noDataColor)),a.outline&&(a.outline={color:a.outline.color&&new l(a.outline.color),width:a.outline.width})),a},flipColors:function(r,l){var i=l?r:x.cloneScheme(r);return i.colors.reverse(),e.forEach(i.colorsForClassBreaks,function(e){e.colors.reverse()}),i},getMatchingSchemes:function(r){var l,i=r.theme,o=d(r.geometryType),a=r.colors,n=v[i],h=s(n),p=[];return e.forEach(h,function(r){var s=t(n,r);s&&(l=g(m(s.primary,s.common,o,i,r),a),l&&p.push(l),e.forEach(s.secondary,function(e){l=g(m(e,s.common,o,i,r),a),l&&p.push(l)}))}),p}}),x});